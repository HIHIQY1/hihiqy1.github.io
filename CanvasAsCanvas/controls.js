var controls=document.getElementById("controls");var cctx=controls.getContext("2d");window.addEventListener("resize",CResFix);controls.addEventListener("mouseup",controlsMouseUp);controls.addEventListener("mousemove",cMouseMove);controls.addEventListener("mouseleave",function(){selectedButton=null});controls.addEventListener("contextmenu",function(e){e.preventDefault()});document.getElementById("colorselector").addEventListener("change",changeColor);document.getElementById("colorselector").value=selectedColor;document.getElementById("fileselector").addEventListener("change",fileSelected);function CResFix(){controls.width=controls.getBoundingClientRect().width;controls.height=controls.getBoundingClientRect().height;cctx.strokeStyle="white";cctx.textBaseline="middle";cctx.font=controls.width/8+"px Arial"}CResFix();var drawModes=["line","dot","square","text"],selectedDrawMode=0,drawMode=drawModes[selectedDrawMode],selectedButton=null,oldActions=[];setTimeout(drawControls,250);function drawControls(){cctx.fillStyle="black";cctx.fillRect(0,0,controls.width,controls.height);cctx.fillStyle="rgb(100, 100, 100)";switch(selectedButton){case"drawModeMinus":cctx.fillRect(0,0,controls.width/8,controls.width/8);break;case"drawModePlus":cctx.fillRect(controls.width/8*7,0,controls.width/8,controls.width/8);break;case"actionMinus":if(JSON.stringify(instructions)!="[]"){cctx.fillRect(0,controls.height-controls.width/8,controls.width/8,controls.width/8)}break;case"actionPlus":if(JSON.stringify(oldActions)!="[]"){cctx.fillRect(controls.width/8,controls.height-controls.width/8,controls.width/8,controls.width/8)}break;case"deleteAll":if(JSON.stringify(instructions)!="[]"){cctx.fillRect(controls.width-controls.width/8,controls.height-controls.width/8,controls.width/8,controls.width/8)}break;case"save":cctx.fillRect(controls.width/8*3,controls.height-controls.width/8,controls.width/8,controls.width/8);break;case"load":cctx.fillRect(controls.width/2,controls.height-controls.width/8,controls.width/8,controls.width/8);break;case"options1":if(drawMode=="line"||drawMode=="dot"||drawMode=="text")cctx.fillRect(0,controls.width/4,controls.width,controls.width/8);break;case"options2":if(drawMode=="text")cctx.fillRect(0,controls.width/8*3,controls.width,controls.width/8);break;case"gear":cctx.fillRect(controls.width/8*7,controls.height-controls.width/8*2,controls.width/8,controls.width/8);break;default:break}cctx.textAlign="left";switch(drawMode){case"line":cctx.strokeText("Line width: "+size,0,controls.width/16*5);break;case"dot":cctx.strokeText("Size: "+size,0,controls.width/16*5);break;case"text":cctx.strokeText("Text size: "+size,0,controls.width/16*5);cctx.strokeText(sampleText,0,controls.width/16*7);break}cctx.textAlign="center";cctx.strokeText("<",controls.width/16,controls.width/16);cctx.strokeText(">",controls.width/16*15,controls.width/16);cctx.strokeText(drawMode,controls.width/2,controls.width/16);cctx.fillStyle=selectedColor;cctx.fillRect(0,controls.height-controls.width/8*3,controls.width,controls.width/8);cctx.strokeStyle="white";cctx.strokeRect(0,controls.height-controls.width/8*3-1,controls.width,controls.width/8);cctx.strokeText("â†©",controls.width/16,controls.height-controls.width/16);cctx.strokeText("â†ª",controls.width/8+controls.width/16,controls.height-controls.width/16);cctx.strokeText("ðŸ—‘",controls.width-controls.width/16,controls.height-controls.width/16);cctx.strokeText("ðŸ–«",controls.width/2-controls.width/16,controls.height-controls.width/16);cctx.strokeText("ðŸ—€",controls.width/16*9,controls.height-controls.width/16);cctx.strokeText("â›­",controls.width/16*15,controls.height-controls.width/16*3);cctx.fillStyle="white";cctx.fillRect(0,0,1,controls.height);setTimeout(drawControls,100)}function controlsMouseDown(e){}function controlsMouseUp(e){if(e.button==0){if(selectedButton=="drawModeMinus"){selectedDrawMode--;switch(selectedDrawMode){case-1:selectedDrawMode=drawModes.length-1;break;default:break}drawMode=drawModes[selectedDrawMode]}else if(selectedButton=="drawModePlus"){selectedDrawMode++;switch(selectedDrawMode){case drawModes.length:selectedDrawMode=0;break;default:break}drawMode=drawModes[selectedDrawMode]}else if(selectedButton=="color"){colorDialog()}else if(selectedButton=="actionMinus"){if(JSON.stringify(instructions)!="[]"){oldActions.push(instructions[instructions.length-1]);instructions.splice(instructions.length-1,1)}}else if(selectedButton=="actionPlus"){if(JSON.stringify(oldActions)!="[]"){instructions.push(oldActions[oldActions.length-1]);oldActions.splice(oldActions.length-1,1)}}else if(selectedButton=="deleteAll"){if(JSON.stringify(instructions)!="[]"){instructions=[];oldActions=[]}}else if(selectedButton=="save"){save()}else if(selectedButton=="load"){document.getElementById("fileselector").click()}else if(selectedButton=="options1"){if(drawMode=="line"||drawMode=="dot"||drawMode=="text"){size=changeVarViaPrompt(size)}}else if(selectedButton=="options2"){if(drawMode=="text"){var textAnswer=prompt("Enter some text:",sampleText);if(textAnswer!=null){sampleText=textAnswer}}}else if(selectedButton=="gear"){var answer=prompt("Change the canvas' size by entering a size, in the following format, in pixels:\n"+canvas.getBoundingClientRect().width+","+canvas.getBoundingClientRect().height);if(answer!=null){changeCanvasSize(answer.split(",")[0],answer.split(",")[1])}}}}function cMouseMove(e){var x=e.x-controls.getBoundingClientRect().x;var y=e.y-controls.getBoundingClientRect().y;if(x>0&&y>0&&x<controls.width/8&&y<controls.width/8){selectedButton="drawModeMinus"}else if(x>controls.width/8*7&&y>0&&x<controls.width&&y<controls.width/8){selectedButton="drawModePlus"}else if(x>0&&y>controls.height-controls.width/8*3&&x<controls.width&&y<controls.height-controls.width/8*2){selectedButton="color"}else if(x>0&&y>controls.height-controls.width/8&&x<controls.width/8&&y<controls.height){selectedButton="actionMinus"}else if(x>controls.width/8&&y>controls.height-controls.width/8&&x<controls.width/4&&y<controls.height){selectedButton="actionPlus"}else if(x>controls.width-controls.width/8&&y>controls.height-controls.width/8&&x<controls.width&&y<controls.height){selectedButton="deleteAll"}else if(x>controls.width/8*3&&y>controls.height-controls.width/8&&x<controls.width/2&&y<controls.height){selectedButton="save"}else if(x>controls.width/2&&y>controls.height-controls.width/8&&x<controls.width/8*5&&y<controls.height){selectedButton="load"}else if(x>0&&y>controls.width/4&&x<controls.width&&y<controls.width/8*3){selectedButton="options1"}else if(x>0&&y>controls.width/8*3&&x<controls.width&&y<controls.width/8*4){selectedButton="options2"}else if(x>controls.width/8*7&&y>controls.height-controls.width/8*2&&x<controls.width&&y<controls.height-controls.width/8){selectedButton="gear"}else{selectedButton=null}}function colorDialog(){var colordialog=document.getElementById("colorselector");colordialog.click()}function changeColor(){var colordialog=document.getElementById("colorselector");selectedColor=colordialog.value}function changeVarViaPrompt(variable){var answer=prompt("Change the size, enter a number:",variable);if(parseInt(answer).toString()=="NaN"){if(answer!=null){changeVarViaPrompt(variable)}}else{variable=answer}return variable}function fileSelected(e){var fileReader=new FileReader;fileReader.addEventListener("load",function(){var imag=new Image;imag.addEventListener("load",function(){instructions=[];changeCanvasSize(imag.width,imag.height);instructions.push({type:"image",img:imag,x:0,y:0,width:imag.width,height:imag.height})});imag.src=fileReader.result});fileReader.readAsDataURL(e.target.files[0])}